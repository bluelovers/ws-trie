"use strict";
/**
 * Created by user on 2018/7/4/004.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const array_hyper_unique_1 = require("array-hyper-unique");
const equals = require("deep-eql");
function allPos(words, positions) {
    let i = 0;
    let ks = Object.keys(positions);
    let len = words.length;
    let j = 0;
    let ret = {};
    while (i < len) {
        if (positions[i]) {
            ret[j] = ret[j] || [];
            if (j != i) {
                ret[j].push(words.slice(j, i));
            }
            ret[i] = ret[i] || [];
            ret[i] = positions[i].slice();
            ret[i].forEach(function (w) {
                let i4;
                let i2;
                let i3;
                for (i2 = 1; i2 < w.length; i2++) {
                    i3 = i + i2;
                    if (positions[i3]) {
                        let s = w.slice(0, i2);
                        i4 = i3 - 1;
                        ret[i4] = ret[i4] || [];
                        ret[i4].push(s);
                    }
                }
                ks.forEach(function (i5) {
                    if (i5 > i3) {
                        let s = words.slice(i3, i5);
                        ret[i3] = ret[i3] || [];
                        ret[i3].push(s);
                    }
                    if (i5 > i) {
                        let s = words.slice(i, i5);
                        ret[i] = ret[i] || [];
                        ret[i].push(s);
                    }
                });
            });
            j = i + 1;
        }
        i++;
    }
    if (j != i) {
        let s = words.slice(j);
        ret[j] = ret[j] || [];
        ret[j].push(s);
    }
    for (let i in ret) {
        ret[i] = array_hyper_unique_1.array_unique(ret[i]);
        ret[i].sort();
    }
    return ret;
}
exports.allPos = allPos;
function allPosMax(words, positions, limit = 5) {
    let ret = allPos(words, positions);
    let _do = true;
    let i = 0;
    let ret2;
    limit = Number(limit);
    limit = limit > 0 ? limit : 5;
    while (_do && limit > i++) {
        ret2 = allPos(words, ret);
        _do = !equals(ret, ret2);
        ret = ret2;
    }
    return ret;
}
exports.allPosMax = allPosMax;
function validPos(positions) {
    return Object.keys(positions)
        .every(function (v) {
        return (v.toString() === Number(v).toString()
            && positions[v]
            && Array.isArray(positions[v]));
    });
}
exports.validPos = validPos;
function triePosList(words, positions) {
    return allPos(words, positions);
}
exports.triePosList = triePosList;
exports.default = triePosList;
exports = Object.assign(triePosList, exports);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7O0FBRUgsMkRBQWtEO0FBQ2xELG1DQUFvQztBQUVwQyxTQUFnQixNQUFNLENBQUMsS0FBYSxFQUFFLFNBR3JDO0lBS0EsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ1YsSUFBSSxFQUFFLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQW9CLENBQUM7SUFDbkQsSUFBSSxHQUFHLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQztJQUV2QixJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFFVixJQUFJLEdBQUcsR0FBRyxFQUFFLENBQUM7SUFFYixPQUFPLENBQUMsR0FBRyxHQUFHLEVBQ2Q7UUFDQyxJQUFJLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFDaEI7WUFDQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUV0QixJQUFJLENBQUMsSUFBSSxDQUFDLEVBQ1Y7Z0JBQ0MsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQy9CO1lBRUQsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDdEIsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUU5QixHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQztnQkFFekIsSUFBSSxFQUFVLENBQUM7Z0JBQ2YsSUFBSSxFQUFVLENBQUM7Z0JBQ2YsSUFBSSxFQUFVLENBQUM7Z0JBQ2YsS0FBSyxFQUFFLEdBQUcsQ0FBQyxFQUFFLEVB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QyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDekIsR0FBRyxHQUFHLElBQUksQ0FBQztLQUNYO0lBRUQsT0FBTyxHQUFHLENBQUM7QUFDWixDQUFDO0FBMUJELDhCQTBCQztBQUVELFNBQWdCLFFBQVEsQ0FBQyxTQUd4QjtJQUVBLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUM7U0FDM0IsS0FBSyxDQUFDLFVBQVUsQ0FBQztRQUVqQixPQUFPLENBQ04sQ0FBQyxDQUFDLFFBQVEsRUFBRSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUU7ZUFDbEMsU0FBUyxDQUFDLENBQUMsQ0FBQztlQUNaLEtBQUssQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQzlCLENBQUE7SUFDRixDQUFDLENBQUMsQ0FDRDtBQUNILENBQUM7QUFmRCw0QkFlQztBQUVELFNBQWdCLFdBQVcsQ0FBQyxLQUFhLEVBQUUsU0FHMUM7SUFFQSxPQUFPLE1BQU0sQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDLENBQUM7QUFDakMsQ0FBQztBQU5ELGtDQU1DO0FBRUQsa0JBQWUsV0FBVyxDQUFBO0FBRTFCLE9BQU8sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlZCBieSB1c2VyIG9uIDIwMTgvNy80LzAwNC5cbiAqL1xuXG5pbXBvcnQgeyBhcnJheV91bmlxdWUgfSBmcm9tICdhcnJheS1oeXBlci11bmlxdWUnO1xuaW1wb3J0IGVxdWFscyA9IHJlcXVpcmUoJ2RlZXAtZXFsJyk7XG5cbmV4cG9ydCBmdW5jdGlvbiBhbGxQb3Mod29yZHM6IHN0cmluZywgcG9zaXRpb25zOiB7XG5cdFtrOiBzdHJpbmddOiBzdHJpbmdbXSxcblx0W2k6IG51bWJlcl06IHN0cmluZ1tdLFxufSk6IHtcblx0W2s6IHN0cmluZ106IHN0cmluZ1tdLFxuXHRbaTogbnVtYmVyXTogc3RyaW5nW10sXG59XG57XG5cdGxldCBpID0gMDtcblx0bGV0IGtzID0gT2JqZWN0LmtleXMocG9zaXRpb25zKSBhcyBhbnkgYXMgbnVtYmVyW107XG5cdGxldCBsZW4gPSB3b3Jkcy5sZW5ndGg7XG5cblx0bGV0IGogPSAwO1xuXG5cdGxldCByZXQgPSB7fTtcblxuXHR3aGlsZSAoaSA8IGxlbilcblx0e1xuXHRcdGlmIChwb3NpdGlvbnNbaV0pXG5cdFx0e1xuXHRcdFx0cmV0W2pdID0gcmV0W2pdIHx8IFtdO1xuXG5cdFx0XHRpZiAoaiAhPSBpKVxuXHRcdFx0e1xuXHRcdFx0XHRyZXRbal0ucHVzaCh3b3Jkcy5zbGljZShqLCBpKSk7XG5cdFx0XHR9XG5cblx0XHRcdHJldFtpXSA9IHJldFtpXSB8fCBbXTtcblx0XHRcdHJldFtpXSA9IHBvc2l0aW9uc1tpXS5zbGljZSgpO1xuXG5cdFx0XHRyZXRbaV0uZm9yRWFjaChmdW5jdGlvbiAodylcblx0XHRcdHtcblx0XHRcdFx0bGV0IGk0OiBudW1iZXI7XG5cdFx0XHRcdGxldCBpMjogbnVtYmVyO1xuXHRcdFx0XHRsZXQgaTM6IG51bWJlcjtcblx0XHRcdFx0Zm9yIChpMiA9IDE7IGkyIDwgdy5sZW5ndGg7IGkyKyspXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRpMyA9IGkgKyBpMjtcblxuXHRcdFx0XHRcdGlmIChwb3NpdGlvbnNbaTNdKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdGxldCBzID0gdy5zbGljZSgwLCBpMik7XG5cblx0XHRcdFx0XHRcdGk0ID0gaTMgLSAxO1xuXG5cdFx0XHRcdFx0XHRyZXRbaTRdID0gcmV0W2k0XSB8fCBbXTtcblxuXHRcdFx0XHRcdFx0cmV0W2k0XS5wdXNoKHMpXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0a3MuZm9yRWFjaChmdW5jdGlvbiAoaTUpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRpZiAoaTUgPiBpMylcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRsZXQgcyA9IHdvcmRzLnNsaWNlKGkzLCBpNSk7XG5cblx0XHRcdFx0XHRcdHJldFtpM10gPSByZXRbaTNdIHx8IFtdO1xuXG5cdFx0XHRcdFx0XHRyZXRbaTNdLnB1c2gocylcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoaTUgPiBpKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdGxldCBzID0gd29yZHMuc2xpY2UoaSwgaTUpXG5cblx0XHRcdFx0XHRcdHJldFtpXSA9IHJldFtpXSB8fCBbXTtcblxuXHRcdFx0XHRcdFx0cmV0W2ldLnB1c2gocylcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pXG5cdFx0XHR9KTtcblxuXHRcdFx0aiA9IGkgKyAxO1xuXHRcdH1cblxuXHRcdGkrKztcblx0fVxuXG5cdGlmIChqICE9IGkpXG5cdHtcblx0XHRsZXQgcyA9IHdvcmRzLnNsaWNlKGopO1xuXG5cdFx0cmV0W2pdID0gcmV0W2pdIHx8IFtdO1xuXG5cdFx0cmV0W2pdLnB1c2gocylcblx0fVxuXG5cdGZvciAobGV0IGkgaW4gcmV0KVxuXHR7XG5cdFx0cmV0W2ldID0gYXJyYXlfdW5pcXVlKHJldFtpXSk7XG5cdFx0cmV0W2ldLnNvcnQoKTtcblx0fVxuXG5cdHJldHVybiByZXQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhbGxQb3NNYXgod29yZHM6IHN0cmluZywgcG9zaXRpb25zOiB7XG5cdFtrOiBzdHJpbmddOiBzdHJpbmdbXSxcblx0W2k6IG51bWJlcl06IHN0cmluZ1tdLFxufSwgbGltaXQgPSA1KToge1xuXHRbazogc3RyaW5nXTogc3RyaW5nW10sXG5cdFtpOiBudW1iZXJdOiBzdHJpbmdbXSxcbn1cbntcblx0bGV0IHJldCA9IGFsbFBvcyh3b3JkcywgcG9zaXRpb25zKTtcblxuXHRsZXQgX2RvID0gdHJ1ZTtcblx0bGV0IGkgPSAwO1xuXHRsZXQgcmV0MjtcblxuXHRsaW1pdCA9IE51bWJlcihsaW1pdCk7XG5cblx0bGltaXQgPSBsaW1pdCA+IDAgPyBsaW1pdCA6IDU7XG5cblx0d2hpbGUgKF9kbyAmJiBsaW1pdCA+IGkrKylcblx0e1xuXHRcdHJldDIgPSBhbGxQb3Mod29yZHMsIHJldCk7XG5cdFx0X2RvID0gIWVxdWFscyhyZXQsIHJldDIpO1xuXHRcdHJldCA9IHJldDI7XG5cdH1cblxuXHRyZXR1cm4gcmV0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRQb3MocG9zaXRpb25zOiB7XG5cdFtrOiBzdHJpbmddOiBzdHJpbmdbXSxcblx0W2k6IG51bWJlcl06IHN0cmluZ1tdLFxufSlcbntcblx0cmV0dXJuIE9iamVjdC5rZXlzKHBvc2l0aW9ucylcblx0XHQuZXZlcnkoZnVuY3Rpb24gKHYpXG5cdFx0e1xuXHRcdFx0cmV0dXJuIChcblx0XHRcdFx0di50b1N0cmluZygpID09PSBOdW1iZXIodikudG9TdHJpbmcoKVxuXHRcdFx0XHQmJiBwb3NpdGlvbnNbdl1cblx0XHRcdFx0JiYgQXJyYXkuaXNBcnJheShwb3NpdGlvbnNbdl0pXG5cdFx0XHQpXG5cdFx0fSlcblx0XHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0cmllUG9zTGlzdCh3b3Jkczogc3RyaW5nLCBwb3NpdGlvbnM6IHtcblx0W2s6IHN0cmluZ106IHN0cmluZ1tdLFxuXHRbaTogbnVtYmVyXTogc3RyaW5nW10sXG59KVxue1xuXHRyZXR1cm4gYWxsUG9zKHdvcmRzLCBwb3NpdGlvbnMpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB0cmllUG9zTGlzdFxuXG5leHBvcnRzID0gT2JqZWN0LmFzc2lnbih0cmllUG9zTGlzdCwgZXhwb3J0cyk7XG4iXX0=